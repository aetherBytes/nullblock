var N=Object.defineProperty;var v=(r,e,t)=>e in r?N(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>(v(r,typeof e!="symbol"?e+"":e,t),t);import{n as y,t as j,p as C,q as $,s as g,f as F,r as h,e as f,v as O,w as J,o as q,a as b}from"./index-B4dGAsJp.js";const M=(r,e,{customContextId:t}={})=>{const s=y(r),a=t||r.libStoreContextId,i=r.displayName||r.name,n=u=>{const c=C(),x=$(),{suspenseId:w}=g(),E=F(),[{contextId:I,initStores:l,mountStores:d}]=h.useState(()=>{const p=a||E;return{contextId:p,initStores:c.createStores(Object.entries(e),x,p,w,i,u),mountStores:()=>c.mountStores(l)}});return h.useEffect(d,[d]),f.createElement(O,{parentId:I,initStores:l},f.createElement(s,{...u,...l}))};return j(n,r),n.displayName=`Mobx(${i})`,Object.defineProperty(n,"name",{value:n.displayName,writable:!1,enumerable:!1})},m=class m{constructor(e,{fieldName:t="sR",errorFields:s=["name","message"]}={}){o(this,"promise");o(this,"store");o(this,"params");o(this,"query",e=>{const{fieldName:t}=this.params;if(!this.isComplete())return this.promise||(this.promise=e(),this.promise.then(()=>{b(()=>{this.store[t]=!0})},s=>{b(()=>{this.errorJson(s),this.store[t]=s})})),m.run(this.promise)});var i;this.store=e,this.params={fieldName:t,errorFields:s};const a=(i=e.init)==null?void 0:i.bind(e);e.init=()=>{this.isComplete(),a==null||a()},J(e,{[t]:!1},{[t]:q})}errorJson(e){e.toJSON=()=>this.params.errorFields.reduce((t,s)=>({...t,[s]:e==null?void 0:e[s]}),{})}jsonToError(e,t){return this.params.errorFields.forEach(s=>{e[s]=t==null?void 0:t[s]}),e}isComplete(){const e=this.store[this.params.fieldName];if(typeof e!="boolean")throw this.jsonToError(new Error((e==null?void 0:e.message)??(e==null?void 0:e.name)),e);return e===!0}};o(m,"run",e=>{if(e){switch(e.status){case"fulfilled":return e.value;case"pending":throw e;case"rejected":throw e.reason;default:e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})}throw e}});let S=m;export{M as p,S as t};
