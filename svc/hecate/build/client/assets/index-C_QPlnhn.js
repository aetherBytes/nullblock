var u=Object.defineProperty;var h=(r,e,a)=>e in r?u(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a;var n=(r,e,a)=>h(r,typeof e!="symbol"?e+"":e,a);import{m as p,o as b,A as f,a as v,r as k,j as s,I as o,F as d,i as g,L as A,b as w}from"./index-DdF6IaCF.js";import{t as F,p as L}from"./suspense-query-DPlGAHmt.js";import{a as S}from"./axios-upsvKRUO.js";class m{constructor(){n(this,"user",null);n(this,"suspense");n(this,"getUser",async(e,a)=>{const{data:l}=await S.request({url:`${f}/?seed=${e}`});await new Promise(i=>{setTimeout(i,e==="user-1"?2e3:1500)});const[{name:c,email:t}]=l.results;v(()=>{const i={id:e,name:Object.values(c).join(" "),email:t,avatar:""};this.user={[a]:i[a]}})});this.suspense=new F(this),p(this,{user:b})}}n(m,"id","Sb");const U={mainStore:m},y=({id:r,fields:e,mainStore:{user:a,suspense:l,getUser:c}})=>{const[t,...i]=e??[];if(!t)return null;l.query(()=>c(r,t));const j=k.useMemo(()=>s.jsx(o,{fallback:s.jsx(d,{}),children:s.jsx(x,{id:r,fields:i})}),[]);return s.jsxs("div",{style:{paddingLeft:"50px",textAlign:"left"},children:[s.jsxs("p",{children:[s.jsxs("strong",{children:[t,":"]})," ",a==null?void 0:a[t]]}),j]})},x=L(y,U),q=()=>s.jsxs(s.Fragment,{children:[s.jsx(g,{children:s.jsx("title",{children:"Nested suspense"})}),s.jsx("p",{children:"Wait until all suspense will be resolved."}),s.jsx("div",{children:"-------"}),s.jsx(o,{fallback:s.jsx(d,{}),children:s.jsx(x,{id:"user-1",fields:["id","name","email"]})}),s.jsx("div",{children:"-------"}),s.jsx(o,{fallback:s.jsx(d,{}),children:s.jsx(x,{id:"user-2",fields:["id","name","email"]})}),s.jsx("div",{children:"-------"}),s.jsx("div",{className:"mr20",children:s.jsx(A,{to:w.makeURL("home"),children:"Go back"})})]});export{q as default};
